language: go
sudo: required
go:
- 1.10.x
services:
- docker
stages:
- test
- name: push
  if: QUAY_USERNAME != "" QUAY_PASSWORD != ""
jobs:
  include:
  - stage: compile
    script: cd $HOME/gopath/src/github.com/integr8ly/keycloak-operator && make setup
      test
  - stage: deploy
    script:
    - docker login --password "QUAY_PASSWORD" --username "QUAY_USERNAME" quay.io;
    - cd $HOME/gopath/src/github.com/integr8ly/keycloak-operator && make build-and-push
      TAG=$TRAVIS_COMMIT;
env:
  global:
    secure: F+fvaTeZlWEcPRPucswX5A4uQy6cbIyHBRGK5XfHJxjW80KNybJrqHbGbykvkpb75L/fRaP+XiGa/rZB1XH6sbJrBPFCS6WxgCywo+JEIpixZhrWTuHJwSoVwqLWSJVn6NaVDS7Z4Hbm/keytCUQ5zA3sIBvMs3aDyizhqlqBY6VX/6bCUYRESvp2P7/cyYpH1q1bNkleGgWHvRQzQ9GE7jzV1olCStxO8+YhNvjY3iFWOig/Y1VlAitui89+fc+2H/w1lj7uhwUVihdRUuRigvHZxBnzJkOv0gCjoBQbH2sS38yQ64KG67pqp2PZma7UCLnpDoKSIurszezVWk04jZW6fxYerF8wKo/pWdOApZjixSDB3r8YKOxfbFRN3qx3/6ocdmchD9lxy5DlT1HgA8PsSQTfAn76J2PmZhjvqVmKy4zxfdawssN26o6Am/5krjeWvV/MIbsoHOgp+pdqK+PrmtQCvK8MxTJQZmicKpPY1FcbiBUXsWabsyE8o7FNIMAPANIPaQqoeJKfkMa8pOnBDiiv8VNcPoqdZl4nWRFWLpj+Pzl5Cy1U08v52Cf9YWUNQz9vP9cesImv75flAsJPepNANIkY0BrJ6LMSyolA2O8Yt9jDhauKxu5cPDeaz/YgnklK0LQwW6FLqwlWiwtSdTWhIYZpsXk/R6TIvY=
