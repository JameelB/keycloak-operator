language: go
sudo: required
go:
- 1.10.x
services:
- docker
stages:
- test
- name: push
  if: QUAY_USERNAME != "" QUAY_PASSWORD != ""
jobs:
  include:
  - stage: compile
    script: cd $HOME/gopath/src/github.com/integr8ly/keycloak-operator && make setup
      test
  - stage: deploy
    script:
    - docker login --password "QUAY_PASSWORD" --username "QUAY_USERNAME" quay.io;
    - cd $HOME/gopath/src/github.com/integr8ly/keycloak-operator && make build-and-push
      TAG=$TRAVIS_COMMIT;
env:
  global:
    secure: WhF0xVhEXA1pdyYKGheYoTD5bvnslOOuFNg8/TsMuWVN++YCUnRGW1l6qzPi2o8KzCXvStnTQBvWNsvuteiAgKBJLv/ygPgRUVr1/luDodJnFYOeVfA6MqKUdwXnHvtF2sHCLVjQWOXToODxeDV0HxLzFJj0ir/VCIaASdv/1kxvgDOTxwDGIpau18HP7e2EyUNO8GvLg5l9g1Bmee8JmR5BQ8nz1h/OGaZbIaMZiwOxtPIKxHR+PSmZ4IQ15WUMweDvjDMnMWRHXdpTOySljLTXki2caSvSPWHAqucTYMDiSNHcIv6Adz1rC0rIbd2n0iuOtTa1HAawjnttOK0GyMJNhHLtXyK2h2awGX3YQ+q6tUYza264QnxYUMlr8ikZ4TqQXmaBHP/raI5GsWcAJ16vlWXqayVBmfFMlwJQVSzLAacjCBI3aWUk5G4lLX5Su6H6yG0LxS1BseR4ldpLEL77wxKMtaPqJzjVbs/NRRqxZKuQEu7Ton5EEfJEWwG9KAAVgO2svLuUdU4RRBZHi2plJMOxYTR1w3JM6OB65bSwnbc1OJCJunfWWDNXUK2RChp1hhQIiNtlfNUu7+4canM63H+1GL1AIwHKum6nI6BJSIyKwWMfYjgbRVwS07oP8dTM3S5bxs78k1drWkGjQwRnm23sqb3ZKeF0hApFFeo=
